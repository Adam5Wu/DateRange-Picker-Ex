/**
 * daterange-picker-ex
 * @version v1.1.1
 * @link https://adam5wu.github.io/DateRange-Picker-Ex/
 * @license MIT
 */
!function(e){"function"==typeof define&&define.amd?define(["jquery","moment"],e):"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("jquery"),require("moment")):e(jQuery,moment)}(function(e,a){"use strict";e.DRPExLang=e.extend({default:"en",en:{selected:"Selected:",day:"Day",days:"Days","apply-disabled":"Close","apply-enabled":"Apply","week-1":"mo","week-2":"tu","week-3":"we","week-4":"th","week-5":"fr","week-6":"sa","week-7":"su","week-number":"W",shortcuts:"Shortcuts",past:"Past",following:"Following",previous:"Previous","prev-week":"Week","prev-month":"Month","prev-year":"Year",next:"Next","next-week":"Week","next-month":"Month","next-year":"Year","less-than":"Date range should not be more than %d days","more-than":"Date range should not be less than %d days","range-start-bound":"Start date range out-of-bound","range-end-bound":"End date range out-of-bound","batch-invalid":'Date range does not satisfy batch constraint "%s"',"disabled-range":"Date range spans across disabled dates","default-more":"Please select a date range longer than %d days","default-single":"Please select a date","default-less":"Please select a date range less than %d days","default-range":"Please select a date range between %d and %d days","default-default":"Please select a date range"}},e.DRPExLang),e.fn.dateRangePicker=function(t){function n(){function n(e){var a=e.parents("table").hasClass("month2"),n=q(a?J.month2:J.month1);!t.singleMonth&&!a&&F(n,J.month2)>=0||Q(n)||(A(n,a?"month2":"month1"),N())}function r(){var e=q(J.month1),a=q(J.month2);Q(a)||(A(e,"month1"),A(a,"month2"),_())}function l(e){var t=e.parents("table").hasClass("month2"),n=H(t?J.month2:J.month1);t&&F(n,J.month1)<=0||Q(a(n).endOf("month").startOf("day").toDate())||(A(n,t?"month2":"month1"),N())}function i(){var e=H(J.month1),t=H(J.month2);Q(a(e).endOf("month").startOf("day").toDate())||(A(t,"month2"),A(e,"month1"),_())}var p=s(J.locale),c=p[0];J.fblocalizer=p[1];var f=J.locale;if(t.language)t.language in e.DRPExLang&&(f=t.language);else{var h=navigator.languages||navigator.userLanguage||(navigator.language?[navigator.language]:[navigator.browserLanguage]);for(var g in h){var u=h[g].toLowerCase();if(u in e.DRPExLang){f=u;break}}}p=s(f),J.locale=p[0],J.localizer=p[1];var m=J.formatter.locale();J.formatter.locale(t.language)._locale||J.formatter.locale(J.locale)._locale||J.formatter.locale(c)._locale||J.formatter.locale(f)._locale||J.formatter.locale(m),J.monthFormat=J.formatter.localeData().longDateFormat("LL").replace(/Y(\s*)[^YMD]*D[^M]*/,"Y$1").replace(/M(\s*)[^YMD]*D[^Y]*/,"M$1").replace(/[^YM]*D[^YM]*/,""),void 0===t.startOfWeek&&(t.startOfWeek=7===J.formatter.startOf("week").isoWeekday()?0:1),J.wrapper=$(),(t.container||e("body")).append(J.wrapper),J.wrapper.delegate(".day","mouseleave",function(){J.wrapper.find(".date-range-length-tip").hide(),W()});var w="";w=o(t.singleDate?"default-single":t.minDays&&t.maxDays?"default-range":t.minDays?"default-more":t.maxDays?"default-less":"default-default");var y=w.replace(/\%d/,t.minDays).replace(/\%d/,t.maxDays);J.wrapper.find(".default-top").html(y).attr("title",y),t.singleMonth?J.wrapper.addClass("single-month"):J.wrapper.addClass("two-months"),J.wrapper.find(".next").click(function(){t.stickyMonths?r(e(this)):n(e(this))}),J.wrapper.find(".prev").click(function(){t.stickyMonths?i(e(this)):l(e(this))}),J.wrapper.delegate(".day","click",function(a){b(e(this))}),J.wrapper.delegate(".day","mouseenter",function(a){C(e(this))}),J.wrapper.delegate(".week-number","click",function(a){k(e(this))}),J.wrapper.delegate(".week-number","mouseenter",function(a){D(e(this))}),J.wrapper.attr("unselectable","on").css("user-select","none").bind("selectstart",function(e){return e.preventDefault(),!1}),J.wrapper.find(".apply-btn").click(function(){M()}),J.wrapper.find("[shortcut]").click(function(){var n,r,s,o=e(this).attr("shortcut"),l=a().startOf("day");if(o.indexOf("day")!=-1){var i=parseInt(o.split(",",2)[1]);0==i?(v(),z()):(n=l.clone().add(i>0?1:-1,"day").toDate(),r=l.add(i,"day").toDate())}else if(o.indexOf("week")!=-1){var s=o.indexOf("prev,")==-1;n=s?l.day(t.startOfWeek?8:7).toDate():l.day(t.startOfWeek?-6:-7).toDate(),r=l.clone().day(t.startOfWeek?7:6).toDate()}else if(o.indexOf("month")!=-1){var s=o.indexOf("prev,")==-1;n=s?l.add(1,"month").date(1).toDate():l.subtract(1,"month").date(1).toDate(),r=l.clone().endOf("month").startOf("day").toDate()}else if(o.indexOf("year")!=-1){var s=o.indexOf("prev,")==-1;n=s?l.add(1,"year").month(0).date(1).toDate():l.subtract(1,"year").month(0).date(1).toDate(),r=l.clone().endOf("year").startOf("day").toDate()}else if("custom"==o){var d=e(this).text(),p=t.shortcuts.custom[d],c="function"==typeof p?p(l):p;if(c&&2==c.length&&(n=c[0],r=c[1]),c&&1==c.length){var f=c[0];A(f,"month1"),N()}}n&&r&&E(n,r)}),t.alwaysOpen||e(document).bind("click.DRPEx",d)}function r(e){if(!J.wrapper){if(void 0!==J.wrapper)throw new Error("Already destroyed");if(e)throw new Error("Not yet initialized")}}function s(a){for(var t=e.DRPExLang[a];t.constructor===String;)a=t,t=e.DRPExLang[t];return[a,t]}function o(e){return J.localizer[e]||J.fblocalizer[e]||"??"}function l(e){if(e.start&&e.end&&a(e.start).isAfter(a(e.end))){var t=e.end;e.end=e.start,e.start=t}}function i(e,a){return a.contains(e.target)||e.target==a}function d(e){i(e,J.anchor[0])||i(e,J.wrapper[0])||J.active&&f(t.animationTime)}function p(){if(J.active){var a=J.anchor.offset(),t=J.anchor.outerWidth(),n=J.anchor.outerHeight();a.right=a.left+t,a.bottom=a.top+n;var r=J.wrapper.offset(),s=J.wrapper.outerWidth(),o=J.wrapper.outerHeight();r.right=r.left+s,r.bottom=r.top+o;var l={top:e(window).scrollTop(),left:e(window).scrollLeft()},i=e(window).width(),d=e(window).height();if(l.right=l.left+i,l.bottom=l.top+d,r.left>=l.left&&r.right<=l.right&&r.top>=l.top&&r.bottom<=l.bottom&&r.left==a.left&&(r.top==a.bottom||J.wrapper.bottom==a.top))return!1;var p,c=a.left+s<=l.right?Math.max(a.left,l.left):Math.max(l.left,l.right-s),f=a.bottom+o<=l.bottom||a.top-o<l.top;if(f){var h=Math.max(a.bottom,l.top);J.wrapper.css({top:h,bottom:"auto",left:c}),p=h-a.bottom}else{var g=e("body").outerHeight(),u=Math.min(a.top,l.bottom);J.wrapper.css({top:"auto",bottom:g-u,left:c}),p=a.top-u}return J.wrapper.css({opacity:.3+.7/Math.log2(2+(p>>7))}),!0}}function c(a){if(!J.active){J.wrapper||n(),J.active=!0,J.wrapper.css({display:"block",visibility:0}),u(),m(),t.container||p(),J.wrapper.css({display:"none",visibility:"initial"});var r=function(){J.anchor.trigger("DRPEx-opened",{relatedTarget:J.wrapper})};if(t.customOpenAnimation?t.customOpenAnimation.call(J.wrapper[0],r):J.wrapper.slideDown(a,r),J.anchor.trigger("DRPEx-open",{relatedTarget:J.wrapper}),t.container||e(window).bind("resize.DRPEx scroll.DRPEx",p),t.watchValueChange){var s=null;J.anchor.bind("input.DRPEx",function(){clearTimeout(s),s=setTimeout(function(){s=null;var e=h(t.getValue.call(J.anchor[0]));e&&g(e,!0)},200)})}return!0}return!1}function f(a){if(!t.alwaysOpen&&J.active){J.active=!1;var n=function(){J.anchor.trigger("DRPEx-closed",{relatedTarget:J.wrapper})};return t.customCloseAnimation?t.customCloseAnimation.call(J.wrapper[0],n):J.wrapper.slideUp(a,n),J.anchor.trigger("DRPEx-close",{relatedTarget:J.wrapper}),t.container||e(window).unbind("resize.DRPEx scroll.DRPEx",p),t.watchValueChange&&J.anchor.unbind("input.DRPEx"),!0}return!1}function h(e){var n=e&&e.constructor==String?e.trim():void 0;if(n){n=e.split(t.separator);for(var r=0;r<n.length;){var s=a(n[r],t.format,a.locale(t.language));if(!s.isValid())break;if(n[r]=s.toDate(),++r>=2)break;if(t.singleDate)break}r!=n.length&&(r>0?n.splice(r):n=void 0)}return n}function g(e,a){E(e[0],e.length>1?e[1]:e[0],a)}function u(){var e=h(t.getValue.call(J.anchor[0]));e&&g(e,!0),z()}function m(){var e=J.wrapper.find(".gap").css("margin-left"),a=J.wrapper.find(".month1").width(),t=J.wrapper.find(".gap").width()+(e?2*parseInt(e):0),n=J.wrapper.find(".month2").width(),r=a+t+n+2;J.wrapper.find(".month-wrapper").width(r);var s=J.wrapper.find(".drp_top-bar input").outerWidth();J.wrapper.find(".drp_top-bar div").width(r-s-2)}function v(){return!(!J.selRange.start&&!J.selRange.end)&&(J.selRange.start=!1,J.selRange.end=!1,J.wrapper.find(".day.checked").removeClass("checked"),J.wrapper.find(".day.range-end").removeClass("range-end"),J.wrapper.find(".day.range-start").removeClass("range-start"),P(),T(),_(),J.anchor.trigger("DRPEx-change",{}),!0)}function w(e){var n=e;return"week-range"===t.batchMode?n=a(e).day(t.startOfWeek?1:0).valueOf():"month-range"===t.batchMode&&(n=a(e).startOf("month").valueOf()),n}function y(e){var n=e;return"week-range"===t.batchMode?n=a(e).day(t.startOfWeek?7:6).valueOf():"month-range"===t.batchMode&&(n=a(e).endOf("month").startOf("day").valueOf()),n}function b(e){if(!J.selWeek&&e.hasClass("valid")&&!e.hasClass("unselectable")){var n=parseInt(e.attr("SOD-time"));if(e.addClass("checked"),t.singleDate?(J.selRange.start=n,J.selRange.end=n):"week"===t.batchMode?(J.selRange.start=a(n).day(t.startOfWeek?1:0).valueOf(),J.selRange.end=a(n).day(t.startOfWeek?7:6).valueOf()):"weekdays"===t.batchMode?(J.selRange.start=a(n).day(1).valueOf(),J.selRange.end=a(n).day(5).valueOf()):"weekends"===t.batchMode?(J.selRange.start=a(n).day(6).valueOf(),J.selRange.end=a(n).day(7).valueOf()):"month"===t.batchMode?(J.selRange.start=a(n).startOf("month").valueOf(),J.selRange.end=a(n).endOf("month").startOf("day").valueOf()):J.selRange.start&&J.selRange.end||!J.selRange.start&&!J.selRange.end?(J.selRange.start=w(n),J.selRange.end=!1):J.selRange.start&&(J.selRange.end=y(n)),l(J.selRange),W(),J.selRange.start&&!J.selRange.end){var r=I(J.selRange.start);J.anchor.trigger("DRPEx-first-date",{value:r,date1:new Date(J.selRange.start)}),C(e),J.wrapper.find(".week-number").removeClass("week-ranged")}x(n),J.selWeek&&(J.selWeek=!1),P(),T(),_(),S()}}function R(a,t){J.wrapper.find(".day").each(function(){var n=parseInt(e(this).attr("SOD-time"));a==n?(e(this).addClass("range-start"),e(this).removeClass("range-end")):t==n?(e(this).removeClass("range-start"),e(this).addClass("range-end")):(e(this).removeClass("range-start"),e(this).removeClass("range-end")),a<=n&&t>=n?e(this).addClass("hovering"):e(this).removeClass("hovering")})}function k(e){if(!t.singleDate&&(!J.selRange.start||J.selRange.end||J.selWeek)&&e.hasClass("valid")&&!e.hasClass("unselectable")){var n=parseInt(e.attr("SOW-time"));if(J.selWeek){W();var r=new Date(n<J.selWeek?n:J.selWeek),s=new Date(n<J.selWeek?J.selWeek:n);J.selWeek=!1,J.selRange.start=a(r).day(t.startOfWeek?1:0).valueOf(),J.selRange.end=a(s).day(t.startOfWeek?7:6).valueOf(),P(),T(),_(),S()}else{J.selWeek=n;var o=new Date(n);J.selRange.start=a(o).day(t.startOfWeek?1:0).valueOf(),J.selRange.end=!1;var l=a(o).day(t.startOfWeek?7:6).valueOf();J.wrapper.find(".day.checked").removeClass("checked"),R(J.selRange.start,l),J.wrapper.find(".week-ranged").removeClass("week-ranged"),e.addClass("week-ranged"),x(),P(),T()}}}function D(e){if(J.selWeek&&!t.singleDate){var n=parseInt(e.attr("SOW-time"));if(n>=J.selWeek){var r=new Date(n),s=a(r).day(t.startOfWeek?7:6).valueOf();R(J.selRange.start,s)}else{var o=new Date(n),l=new Date(J.selWeek),i=a(o).day(t.startOfWeek?1:0).valueOf(),s=a(l).day(t.startOfWeek?7:6).valueOf();R(i,s)}}}function O(e){if(Q(e))return!1;if(!t.singleDate){if(t.maxDays>0&&j(e,J.selRange.start)>t.maxDays||t.minDays>0&&j(e,J.selRange.start)<t.minDays)return!1;if(t.selectForward&&e<J.selRange.start||t.selectBackward&&e>J.selRange.start)return!1}if(t.beforeShowDay){for(var n=a(e);V(n,J.selRange.start);){var r=t.beforeShowDay(n.toDate());if(r[0]===!1)return!1;n.add(e<J.selRange.start?1:-1,"day")}return t.beforeShowDay(n.toDate())[0]!==!1}return!0}function x(){return J.wrapper.find(".unselectable").removeClass("unselectable"),J.selRange.start&&(J.selRange.end?(J.wrapper.find(".day.toMonth.valid").each(function(){var a=parseInt(e(this).attr("SOD-time"));a>=J.selRange.start&&a<=J.selRange.end&&(O(a)||e(this).addClass("unselectable"))}),J.wrapper.find(".week-number.valid").each(function(){var n=parseInt(e(this).attr("SOW-time"));n>=J.selRange.start&&(n=a(n).day(t.startOfWeek?7:6).toDate(),n<=J.selRange.end&&(O(n)||e(this).addClass("unselectable")))})):(J.wrapper.find(".day.toMonth.valid").each(function(){var a=parseInt(e(this).attr("SOD-time"));O(a)||e(this).addClass("unselectable")}),J.wrapper.find(".week-number.valid").each(function(){var n=parseInt(e(this).attr("SOW-time"));n>=J.selRange.start&&(n=a(n).day(t.startOfWeek?7:6).toDate()),O(n)||e(this).addClass("unselectable")}))),!0}function C(a){if(!J.selWeek){var n=parseInt(a.attr("SOD-time")),r="";if(a.hasClass("has-tooltip")&&a.attr("data-tooltip"))r='<span style="white-space:nowrap">'+a.attr("data-tooltip")+"</span>";else if(a.hasClass("valid")&&!a.hasClass("unselectable"))if(t.singleDate)J.wrapper.find(".day.hovering").removeClass("hovering"),a.addClass("hovering");else if(J.wrapper.find(".day").each(function(){var a=parseInt(e(this).attr("SOD-time"));a==n?e(this).addClass("hovering"):e(this).removeClass("hovering"),J.selRange.start&&!J.selRange.end&&(J.selRange.start<a&&n>=a||J.selRange.start>a&&n<=a)?e(this).addClass("hovering"):e(this).removeClass("hovering")}),J.selRange.start&&!J.selRange.end){var s=j(n,J.selRange.start);t.hoveringTooltip&&("function"==typeof t.hoveringTooltip?r=t.hoveringTooltip(s,J.selRange.start,n):t.hoveringTooltip===!0&&s>1&&(r=s+" "+o("days")))}if(r){var l=a.offset(),i=J.wrapper.offset(),d=l.left-i.left,p=l.top-i.top;d+=a.width()/2;var c=J.wrapper.find(".date-range-length-tip"),f=c.css({visibility:"hidden",display:"none"}).html(r).width(),h=c.height();d-=f/2,p-=h,c.css({left:d,top:p,display:"block",visibility:"visible"})}else J.wrapper.find(".date-range-length-tip").hide()}}function W(){J.wrapper.find(".day.hovering").removeClass("hovering"),J.wrapper.find(".date-range-length-tip").hide()}function M(){if(J.selRange.start&&J.selRange.end){var e,a,n;t.singleDate?(e=I(J.selRange.start),J.anchor.trigger("DRPEx-apply",{value:e,date1:new Date(J.selRange.start)})):(a=I(J.selRange.start),n=I(J.selRange.end),e=a+t.separator+n,J.anchor.trigger("DRPEx-apply",{value:e,date1:[new Date(J.selRange.start),a],date2:[new Date(J.selRange.end),n]})),t.setValue.call(J.anchor[0],e,a,n)}f(t.animationTime)}function S(){t.autoClose&&J.selRange.start&&(t.singleDate||J.selRange.end)&&M()}function P(){var e=!0,n=J.selRange.start&&J.selRange.end?j(J.selRange.start,J.selRange.end):NaN;if(t.singleDate)J.selRange.start||(e=void 0);else if(t.maxDays&&n>t.maxDays){var r=o("less-than").replace("%d",t.maxDays);J.wrapper.find(".drp_top-bar .error-top").html(r).attr("title",r),e=!1}else if(t.minDays&&n<t.minDays){var r=o("more-than").replace("%d",t.minDays);J.wrapper.find(".drp_top-bar .error-top").html(r).attr("title",r),e=!1}else isNaN(n)&&(e=void 0);if(e)if(Q(J.selRange.start)){var r=o("range-start-bound");J.wrapper.find(".drp_top-bar .error-top").html(r).attr("title",r),e=!1}else if(Q(J.selRange.end)){var r=o("range-end-bound");J.wrapper.find(".drp_top-bar .error-top").html(r).attr("title",r),e=!1}if(e&&t.batchMode){var s=a(J.selRange.start),l=a(J.selRange.end);switch(t.batchMode){case"week":s.isSame(s.clone().day(t.startOfWeek?1:0))&&l.isSame(s.clone().day(t.startOfWeek?7:6))||(e=!1);break;case"weekdays":s.isSame(s.clone().day(1))&&l.isSame(s.clone().day(5))||(e=!1);break;case"weekends":s.isSame(s.clone().day(6))&&l.isSame(s.clone().day(0))||(e=!1);break;case"month":s.isSame(s.clone().startOf("month"))&&l.isSame(s.clone().endOf("month").startOf("day"))||(e=!1);break;case"week-range":s.isSame(s.clone().day(t.startOfWeek?1:0))&&l.isSame(l.clone().day(t.startOfWeek?7:6))||(e=!1);break;case"month-range":s.isSame(s.clone().startOf("month"))&&l.isSame(l.clone().endOf("month").startOf("day"))||(e=!1);break;default:throw new Error("Unrecognized batch mode - "+t.batchMode)}if(!e){var r=o("batch-invalid").replace("%s",t.batchMode);J.wrapper.find(".drp_top-bar .error-top").html(r).attr("title",r)}}if(e&&(e=O(J.selRange.end),!e)){var r=o("disabled-range");J.wrapper.find(".drp_top-bar .error-top").html(r).attr("title",r)}return e?(J.wrapper.find(".drp_top-bar").removeClass("error").addClass("normal"),J.wrapper.find(".apply-btn").removeClass("disabled").val(o("apply-enabled"))):(void 0==e?J.wrapper.find(".drp_top-bar").removeClass("error").addClass("normal"):J.wrapper.find(".drp_top-bar").addClass("error").removeClass("normal"),J.wrapper.find(".apply-btn").addClass("disabled").val(o("apply-disabled"))),e}function T(e){J.wrapper.find(".start-day").html("..."),J.wrapper.find(".end-day").html("..."),J.wrapper.find(".selected-days").hide(),J.selRange.start&&J.wrapper.find(".start-day").html(I(J.selRange.start)),J.selRange.end&&J.wrapper.find(".end-day").html(I(J.selRange.end)),J.selRange.start&&t.singleDate?e||J.anchor.trigger("DRPEx-change",{date1:new Date(J.selRange.start)}):J.selRange.start&&J.selRange.end&&(J.wrapper.find(".selected-days").show().find(".selected-days-num").html(j(J.selRange.end,J.selRange.start)),e||J.anchor.trigger("DRPEx-change",{date1:new Date(J.selRange.start),date2:new Date(J.selRange.end)}));var a=J.wrapper.find(".drp_top-bar .normal-top");a.attr("title",a.text())}function E(e,a,n){var r={start:e,end:a};l(r),J.selRange.start==r.start.getTime()&&J.selRange.end==r.end.getTime()||(J.selRange.start=r.start.getTime(),J.selRange.end=r.end.getTime(),(t.stickyMonths||V(r.start,r.end)>0&&0===F(r.start,r.end))&&(t.lookBehind?r.start=H(r.end):r.end=q(r.start)),t.stickyMonths?t.dateRange.end!==!1&&F(r.end,t.dateRange.end)>0&&(r.start=H(r.start),r.end=H(r.end)):0===F(r.start,r.end)&&(t.lookBehind?r.start=H(r.end):r.end=q(r.start)),A(r.start,"month1"),A(r.end,"month2"),N(),P(),T(n),_()),n||S()}function _(){(J.selRange.start||J.selRange.end)&&(J.wrapper.find(".day").each(function(){var a=parseInt(e(this).attr("SOD-time"));J.selRange.end&&J.selRange.end>=a&&J.selRange.start<=a||!J.selRange.end&&J.selRange.start==a?e(this).addClass("checked"):e(this).removeClass("checked"),J.selRange.start==a?e(this).addClass("range-start"):e(this).removeClass("range-start"),J.selRange.end==a?e(this).addClass("range-end"):e(this).removeClass("range-end")}),J.wrapper.find(".week-number").each(function(){parseInt(e(this).attr("SOW-time"))==J.selWeek&&e(this).addClass("week-ranged")}),J.selRange.end&&J.wrapper.find(".week-number").each(function(){var n=new Date(parseInt(e(this).attr("SOW-time"))),r=a(n).day(t.startOfWeek?1:0).valueOf(),s=a(n).day(t.startOfWeek?7:6).valueOf();r>=J.selRange.start&&s<=J.selRange.end?e(this).addClass("week-ranged"):e(this).removeClass("week-ranged")}))}function A(e,t){e=a(e).startOf("month").toDate(),J.wrapper.find("."+t+" .month-name").html(B(e)),J.wrapper.find("."+t+" tbody").html(X(e)),J[t]=e,x()}function B(e){return J.formatter.toDate().setTime(e),J.formatter.format(J.monthFormat)}function I(e){return J.formatter.toDate().setTime(e),J.formatter.format(t.format)}function N(){F(J.month2,J.month1)>1?J.wrapper.addClass("has-gap").removeClass("no-gap").find(".gap").css("visibility","visible"):J.wrapper.removeClass("has-gap").addClass("no-gap").find(".gap").css("visibility","hidden");var e=J.wrapper.find("table.month1").height(),a=J.wrapper.find("table.month2").height();J.wrapper.find(".gap").height(Math.max(e,a)+10)}function Y(){A(J.month1,"month1"),A(J.month2,"month2")}function L(){var e=t.defaultTime?t.defaultTime:new Date;return t.dateRange.start&&F(e,t.dateRange.start)<0?e=a(t.dateRange.start).toDate():t.dateRange.end&&F(e,t.dateRange.end)>0&&(e=H(a(t.dateRange.end).toDate())),e}function z(){var e=J.selRange.start,a=J.selRange.end;e?0==F(e,a)&&(t.lookBehind?t.dateRange.start&&F(e,t.dateRange.start)>0&&(e=H(e)):a=q(a)):(e=L(),a=q(e)),A(e,"month1"),A(a,"month2"),N(),_()}function F(e,t){return a(e).startOf("month").diff(a(t).startOf("month"),"month")}function V(e,t){return a(e).diff(a(t),"day")}function j(e,a){return Math.abs(V(e,a))+1}function q(e){return a(e).add(1,"month").toDate()}function H(e){return a(e).add(-1,"month").toDate()}function U(a,t,n){var r="<"+a;return t&&(e.each(t,function(e,a){r+=" "+e+'="'+a+'"'}),void 0!==n&&(r+=n?">"+n+"</"+a:"/")),r+">"}function $(){var a=U("div",{class:"date-picker-wrapper"+(t.haveTopbar?t.customTopBar?" custom-topbar":"":" no-topbar ")+(t.inline?" inline-wrapper":"")});t.haveTopbar&&(a+=U("div",{class:"drp_top-bar"}),t.customTopBar?a+=U("div",{class:"custom-top"},"function"==typeof t.customTopBar?t.customTopBar():t.customTopBar):(a+=U("div",{class:"normal-top"})+U("span",{},o("selected"))+" "+U("b",{class:"start-day"},"(Start day)"),t.singleDate||(a+=U("span",{class:"separator-day"},t.separator)+U("b",{class:"end-day"},"(End day)")+U("i",{class:"selected-days"})+" ("+U("span",{class:"selected-days-num"},"X")+" "+o("days")+")"+U("/i")),a+=U("/div"),a+=U("div",{class:"error-top"},"Error message")+U("div",{class:"default-top"},"Default message")),a+=U("input",{type:"button",value:o("apply-disabled"),class:"apply-btn disabled"+(t.autoClose?" hide":"")+(t.applyBtnClass?" "+t.applyBtnClass:"")},""),a+=U("/div")),a+=U("div",{class:"month-wrapper"});var n=function(){var e="";return t.showWeekNumbers&&(e+=U("th",{},o("week-number"))),e+=t.startOfWeek?U("th",{},o("week-1"))+U("th",{},o("week-2"))+U("th",{},o("week-3"))+U("th",{},o("week-4"))+U("th",{},o("week-5"))+U("th",{},o("week-6"))+U("th",{},o("week-7")):U("th",{},o("week-7"))+U("th",{},o("week-1"))+U("th",{},o("week-2"))+U("th",{},o("week-3"))+U("th",{},o("week-4"))+U("th",{},o("week-5"))+U("th",{},o("week-6"))},r=function(e){var a=U("table",{class:e,cellspacing:"0",border:"0",cellpadding:"0"});return a+=U("thead")+U("tr",{class:"caption"})+U("th",{class:"button"},U("span",{class:"prev"},t.customArrowPrevSymbol||"&lt;"))+U("th",{class:"month-name",colspan:t.showWeekNumbers?6:5},"(Month)")+U("th",{class:"button"},U("span",{class:"next"},t.customArrowNextSymbol||"&gt;"))+U("/tr")+U("tr",{class:"week-name"},n())+U("/thead"),a+U("tbody",{},"")+U("/table")};if(a+=r("month1"),!t.singleMonth){var s=function(){for(var e=U("div",{class:"gap"})+U("div",{class:"gap-top-mask"},"")+U("div",{class:"gap-bottom-mask"},"")+U("div",{class:"gap-lines"}),a=0;a<20;a++)e+=U("div",{class:"gap-line"},U("div",{class:"gap-1"},"")+U("div",{class:"gap-2"},"")+U("div",{class:"gap-3"},""));return e+U("/div")+U("/div")};a+=s()+r("month2")}a+=U("div",{class:"spacer"},"")+U("/div"),a+=U("div",{class:"footer"});var l=function(){var a="",n=t.shortcuts;if(n["prev-days"]&&n["prev-days"].length>0){a+=U("span",{class:"prev-days"})+o("past");for(var r=0;r<n["prev-days"].length;r++){var s=n["prev-days"][r];a+=U("span",{class:"shortcut",shortcut:"day,-"+s},s+" "+o(s>1?"days":"day"))}a+=U("/span")}if(n["next-days"]&&n["next-days"].length>0){a+=U("span",{class:"next-days"})+o("following");for(var r=0;r<n["next-days"].length;r++){var s=n["next-days"][r];a+=U("span",{class:"shortcut",shortcut:"day,+"+s},s+" "+o(s>1?"days":"day"))}a+=U("/span")}if(n.prev&&n.prev.length>0){a+=U("span",{class:"prev-buttons"})+o("previous");for(var r=0;r<n.prev.length;r++){var l=n.prev[r];a+=U("span",{class:"shortcut",shortcut:"prev,"+l},o("prev-"+l))}a+=U("/span")}if(n.next&&n.next.length>0){a+=U("span",{class:"next-buttons"})+o("next");for(var r=0;r<n.next.length;r++){var l=n.next[r];a+=U("span",{class:"shortcut",shortcut:"next,"+l},o("next-"+l))}a+=U("/span")}if(n.custom&&!e.isEmptyObject(n.custom)){a+=U("span",{class:"custom-buttons"});for(var i in n.custom)a+=U("span",{class:"shortcut",shortcut:"custom"},i);a+=U("/span")}return a},i=l();return a+=U("div",{class:"shortcuts"+(i?"":" none")},U("b",{},o("shortcuts"))+i),a+=U("/div"),a+=U("div",{class:"date-range-length-tip"},""),a+=U("/div"),e(a)}function Q(e){return e=a(e),t.dateRange.start&&e.isBefore(t.dateRange.start)||t.dateRange.end&&e.isAfter(t.dateRange.end)}function X(e){var n=[];e.setDate(1);var r=e.getDay();if(0===r&&t.startOfWeek&&(r=7),r>0)for(var s=r;s>0;s--){var o=a(e).subtract(s,"day").toDate();n.push({date:o,type:"lastMonth",day:o.getDate(),time:o.getTime(),valid:!Q(o.getTime())})}for(var l=e.getMonth(),s=0;s<40;s++){var i=a(e).add(s,"day").toDate();n.push({date:i,type:i.getMonth()==l?"toMonth":"nextMonth",day:i.getDate(),time:i.getTime(),valid:!Q(i.getTime())})}var d="",p=a(),c=p.diff(e,"month",!0);(c<0||c>1)&&(p=!1);for(var f=0;f<6&&"nextMonth"!=n[7*f].type;f++){d+=U("tr");for(var h,g="",u=!0,o=0;o<7;o++){var m=7*f+(t.startOfWeek?o+1:o),i=n[m];if(0===o&&(h=i),i.extraClass="",i.tooltip="",i.valid&&t.beforeShowDay){var v=t.beforeShowDay(i.date);i.valid=v[0],i.extraClass=v[1]||"",i.tooltip=v[2]||"",""!==i.tooltip&&(i.extraClass+=" has-tooltip ")}u=u&&i.valid,t.startOfWeek?o>=5&&(i.extraClass+=" weekend "):0!=o&&6!=o||(i.extraClass+=" weekend "),g+=U("td",{},U("div",{"SOD-time":i.time,"data-tooltip":i.tooltip,class:"day "+i.type+" "+i.extraClass+" "+(i.valid?"valid":i.valid===!1?"invalid":"skipped")+(p&&p.date()==i.day?" real-today":"")},G(i.time,i.day)))}t.showWeekNumbers&&(d+=U("td",{},U("div",{class:"week-number "+(u?"valid":"invalid"),"SOW-time":h.time},t.getWeekNumber(h.date)))),d+=g+U("/tr")}return d}function G(e,a){return t.showDateFilter&&"function"==typeof t.showDateFilter?t.showDateFilter(e,a):a}t=e.extend({autoClose:!1,format:"YYYY-MM-DD",separator:" to ",language:void 0,startOfWeek:void 0,getValue:function(){return e(this).val()},setValue:function(a){a!=e(this).val()&&e(this).val(a).change()},dateRange:{start:!1,end:!1},minDays:0,maxDays:0,shortcuts:{},watchValueChange:!0,container:void 0,alwaysOpen:!1,dropTrigger:!0,singleDate:!1,lookBehind:!1,batchMode:!1,animationTime:200,stickyMonths:!1,selectForward:!1,selectBackward:!1,applyBtnClass:"",singleMonth:!1,hoveringTooltip:function(e,a,t){return e>1?e+" "+o("days"):""},haveTopbar:!0,showWeekNumbers:!1,getWeekNumber:function(e){return a(e).format("w")},customOpenAnimation:null,customCloseAnimation:null,customArrowPrevSymbol:null,customArrowNextSymbol:null},t),t.singleMonth&&(t.stickyMonths=!1),t.haveTopbar||(t.autoClose=!0),t.singleDate&&(t.batchMode=!1),t.dateRange.start&&t.dateRange.start.constructor==String&&(t.dateRange.start=a(t.dateRange.start,t.format).toDate()),t.dateRange.end&&t.dateRange.end.constructor==String&&(t.dateRange.end=a(t.dateRange.end,t.format).toDate()),l(t.dateRange);var J={selRange:{start:!1,end:!1},selWeek:!1,active:!1,locale:"default",localizer:{},fblocalizer:{},formatter:a(),monthFormat:"??",anchor:e(this),wrapper:void 0};return t.dropTrigger&&J.anchor.bind("click.DRPEx",function(e){J.active||c(t.animationTime)}),t.alwaysOpen&&c(0),J.anchor.data("DRPEx",{setStart:function(e,n){return r(!0),e.constructor==String&&(e=a(e,t.format).toDate()),E(e,J.selRange.end?a(J.selRange.end).toDate():e,n),this},setEnd:function(e,n){return r(!0),e.constructor==String&&(e=a(e,t.format).toDate()),E(J.selRange.start?a(J.selRange.start).toDate():e,e,n),this},setDateRange:function(e,n,s){r(!0),e.constructor==String&&(e=a(e,t.format).toDate()),n.constructor==String&&(n=a(n,t.format).toDate()),E(e,n,s)},setDateText:function(e,a){r(!0);var t=h(e);return t&&g(t,a),t},open:function(e){return r(),c(e)},close:function(e){return r(),f(e)},clear:function(){return r(),v()},redraw:function(){r(),J.wrapper&&Y()},resetMonthsView:function(){r(),J.wrapper&&z()},wrapper:function(){return r(!0),J.wrapper},anchor:function(){return r(),J.anchor},isActive:function(){return r(),J.active},destroy:function(){r(),J.anchor.unbind(".DRPEx"),J.anchor.data("DRPEx",void 0),J.wrapper&&J.wrapper.remove(),J.wrapper=null,e(window).unbind("resize.DRPEx scroll.DRPEx",p),e(document).unbind("click.DRPEx",d)}}),this}});